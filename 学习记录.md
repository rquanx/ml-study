## 基本数学

y = ∅0 + ∅1x，为了避免有太多不同名称的变量引起混淆，使用∅x
次数越多，曲线越复杂，但是同时也更能表达现实

目标函数推广到n次幂，此时可使用矩阵来简化表示

损失函数？

#### 最小二乘法

[最小二乘法（least sqaure method）](https://zhuanlan.zhihu.com/p/38128785?utm_id=0)
> 在几何上的意义是寻找在最优解参数平面上的投影？即高维到低维的投影？

基于模型 + 误差 ==> 目标函数最小值 ==> 最优解

![17041255014441704125501269.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17041255014441704125501269.png)

假设我们的模型是fθ(x),未知数是θ0 ~ θn，现在数据集的值是y

那么就得到我们的期望等式: fθ(x) = y == y - fθ(x) = 0，继而得到目标函数

**目标函数**

目标函数就是帮助我们找到误差点最小的参数，让目标函数得出的结果最小，就是最小二乘法的最优解？

实际过程我们是不断带入参数进行验证模型是否匹配
- 那么就可以知道在预设未知数后，每个点的期望等式的误差，总的误差就是所有点误差的和
- 由于误差有正负，有可能导致误差和为0，进行平方即可消除正负问题
  - 平方的作用：统一正负误差的正误差
  - 为什么不用绝对值？为了方便进行求导运算

平方误差：
由上得目标函数：1/2 * 误差的平方和
- 由于是平方，所有 * 1/2 方便后续求导运算
  - * 常熟，在图像上可以看出会对图像有影响，但是最小值的位置并不影响，即最小值的参数不影响，我们最终的目的也只是找出误差最小值的点

平方误差的总和叫误差函数、损失函数，代价函数
![17041255554421704125555146.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17041255554421704125555146.png)

为了是目标函数最小，有多种处理方式

**最速下降法/梯度下降法**

利用了导数，导数的大小代表了数值变化的方向，负数是递减，正数是递增

取某一个点，沿它切到的负数方向一直找到导数为0的位置，即为最小值位置

更新表达式：通过 x 来描述下一个 x 的表达式，通过不断带入数据即可不断刷新 x 的值，直到不变（收敛）即可结束
![17042204554441704220454714.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17042204554441704220454714.png)

伊塔: 学习率，用来控制每次变换量的系数，值越大，每次变化的幅度越大，计算速度越快
- 如果幅度比较大，可能会出现无法收敛，不断的反复横跳问题

对于每个未知数都可以通过偏导，得到这个未知数的更新函数

![17042208314421704220831125.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17042208314421704220831125.png)

偏导计算过程：
![17042208664441704220865537.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17042208664441704220865537.png)
![17042208974421704220896593.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17042208974421704220896593.png)
![17042209104441704220910120.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17042209104441704220910120.png)

缺点：容易陷入局部最优解

**多项式回归**

基于一次函数的模型，增加多项式中的次数，进行扩展分析，并且多项式越多，越能表达复杂的曲线
- 可能会出现过拟合，即模型太复杂，反而无法很好的解决简单问题

#### 多重回归

包含多个变量的回归叫多为回归

当参数较多时，可以使用矩阵进行简化
![17043083594451704308358556.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17043083594451704308358556.png)

为了对齐矩阵的长度，增加一个1的元素
![17043083854451704308384732.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17043083854451704308384732.png)

将1当作是x0，矩阵可以写成
![17043084174421704308417247.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17043084174421704308417247.png)

转置 + 两个矩阵相乘，就可以简化为θTx的等式
![17043084284451704308428218.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17043084284451704308428218.png)

![17043084624461704308462240.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17043084624461704308462240.png)


将更新函数推广，等到任意元素的更新函数
![17043086364421704308636292.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17043086364421704308636292.png)

#### 随机梯度下降法

随机选择训练数据，对他进行更新函数计算，由于是随机选，不容易陷入局部最优

随机选一个
![17043925944441704392593683.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17043925944441704392593683.png)

随机选M个： 小批量梯度下降？
![17043926654431704392664543.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17043926654431704392664543.png)

#### 小批量梯度下降


## 基本概念

目的是从数据中找出特征和模式

擅长领域
- 回归：处理连续数据如时间序列数据时使用的技术，有监督学习
  - 根据数据进行预测下一个数据
  - 需要预测什么就需要把影响它的因子的数据收集起来
- 分类：进行带标签数据的分类，主要是根据标签进行分类，有监督学习
  - 二分类：是否
  - 多分类：数字识别
- 聚类：进行不带标签的数据的分类，只能从数据本身的特征进行分类，无监督学习

#### 过拟合（Overfitting）

是指在机器学习和统计建模中，一个模型过于复杂，以至于它不仅拟合了训练数据中的有效规律，还拟合了一些噪声或异常数据。这会导致模型在训练集上表现良好，但在新数据（测试集）上表现较差，泛化能力较弱。
过拟合的原因可能有以下几点：
1. 模型过于复杂：模型的复杂度与训练数据的复杂度不匹配，导致模型过于复杂，过度拟合训练数据。
2. 数据量不足：训练数据量太少，无法代表真实的数据分布，容易导致过拟合。
3. 数据噪声：数据中存在较多噪声或异常值，模型将这些噪声误认为是有效规律，从而过度拟合。
为了避免过拟合，可以采取以下措施：
1. 增加训练数据：扩大训练集规模，以便更好地捕捉数据分布。
2. 减小模型复杂度：选择更简单的模型，避免过度拟合。
3. 正则化：在损失函数中添加正则化项，限制模型参数的大小，降低模型复杂度。
4. 交叉验证：使用交叉验证技术，将训练集划分为若干份，交替使用其中一部分作为验证集，以获得对模型泛化能力的更准确估计。

#### 有监督/无监督

- 有监督学习：使用有标签的数据进行的学习
- 无监督学习：使用没有标签的数据进行的学习

## 模型

最终无法取到最优解：解是根据数据集来的，如果本身数据集的分布就是相对混乱的，是有可能无法实现误差为0的拟合的
> 理想情况下是误差为0，但是很难达到，所以只要误差接近 0，就可以说这是合乎数据的模型
> 之所以说合乎数据的模型，因为这个解就是为了解数据集来的，所以数据集的优略决定了解

模型参数量：模型的参数个数大于数据规模时又如何呢？当然，这时参数就不确定了。因此，要确定模型，就必须准备好规模大于参数个数的数据

#### 一次函数模型

使用一次函数来进行预测，其中θ0和θ1为未知数，训练过程就是根据数据找出合适的θ0、θ1

![17041252894431704125288550.png](https://fastly.jsdelivr.net/gh/rquanx/my-statics@master/images/17041252894431704125288550.png)

**为什么是θ0、1、2......**

如果使用a、b、c.....会参数太多，不易理解，而且会出现符号不够用问题

## 应用

### 分类

#### 对图片的纵横向进行分类

根据图片的长和宽，判断方向


法线：始终垂直于某平面的虚线
1、通过向量垂直时积为0的的特性